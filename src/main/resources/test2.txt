2021-01-27 16:01:53.831  INFO 14515 --- [nio-8765-exec-3] c.i.c.b.c.p.v.PermissionValidation       : 超级管理员角色key:  system-service:data-auth:user:ea7b8719-8cdc-4df5-859a-103cf007fb77
2021-01-27 16:01:53.832  INFO 14515 --- [nio-8765-exec-3] c.i.c.b.c.p.v.PermissionValidation       : 超级管理员角色value: "superman"
Creating a new SqlSession
SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4700a014] was not registered for synchronization because synchronization is not active
JDBC Connection [com.alibaba.druid.proxy.jdbc.ConnectionProxyImpl@7ba67256] will not be managed by Spring
==>  Preparing: select count(0) from (SELECT DISTINCT cms.id, cms.rpid as rpId, cms.`code`, pcc.area_id, pa.`name` area_name, pcc.mu_id, pu.`name` mu_name, cms.center_id, pcc.`name` center_name, cms.contract_id, bci.contract_code, case when bci.contract_name is null then cms.contract_name else bci.contract_name end as contract_name, cms.gross_margin_rate, cms.expect_gross_margin, cms.actual_gross_margin, case when bci.tax_rate is null then cms.tax_rate else bci.tax_rate end tax_rate, bci.user_id, uoc.alias user_name, cms.recv_milepost, cms.plan_month, cms.expect_month_time, cms.expect_month_amount, CASE WHEN bci.tax_rate IS NULL THEN ROUND(cms.expect_month_amount /(1+cms.tax_rate / 100), 2) ELSE ROUND(cms.expect_month_amount /(1+bci.tax_rate / 100), 2) END expect_month_income, cms.recv_power_prediction, cms.returnable, cms.expect_week_time, cms.expect_week_amount, CASE WHEN bci.tax_rate IS NULL THEN ROUND(cms.expect_week_amount /(1+cms.tax_rate / 100), 2) ELSE ROUND(cms.expect_week_amount /(1+bci.tax_rate / 100), 2) END expect_week_income, cms.week_recv_power_prediction, cms.week_returnable, cms.actual_recv_time, cms.actual_recv_income, CASE WHEN cms.actual_plan_recv_income IS NULL THEN NULL WHEN (CASE WHEN bci.tax_rate IS NULL THEN ROUND(cms.expect_month_amount /(1+cms.tax_rate / 100), 2) ELSE ROUND(cms.expect_month_amount /(1+bci.tax_rate / 100), 2) END) > cms.actual_plan_recv_income then cms.actual_plan_recv_income ELSE( (CASE WHEN bci.tax_rate IS NULL THEN ROUND(cms.expect_month_amount /(1+cms.tax_rate / 100), 2) ELSE ROUND(cms.expect_month_amount /(1+bci.tax_rate / 100), 2) END) ) END actual_plan_recv_income, cms.receivable_flag, cms.recv_progress, cms.manage_power_predict, cms.manage_power_income, case when cms.expect_month_time < DATE_ADD( CURRENT_DATE, INTERVAL - DAY ( CURRENT_DATE ) + 1 DAY ) then 'archive' when cal.type is null then cms.status else cal.type end as status, cms.creator, cms.create_time, cms.modifier, cms.modify_time FROM contract_monthly_schedule cms LEFT JOIN busiopt_contract_info bci ON cms.contract_id = bci.contract_id LEFT JOIN user_organ_collect uoc ON uoc.user_id = cms.user_id LEFT JOIN ( SELECT contract_milepost_code, sum( money ) sum_money, max( collection_time ) max_collection_time FROM contract_payment_new GROUP BY contract_milepost_code order by null) cp ON cp.contract_milepost_code = cms.code LEFT JOIN product_cloud_center pcc ON cms.center_id = pcc.id LEFT JOIN product_mu pu ON pu.`id` = pcc.mu_id LEFT JOIN product_area pa ON pa.`id` = pcc.area_id LEFT JOIN contract_audit_lock cal ON cal.plan_month = cms.plan_month WHERE 1 = 1 AND cms.expect_month_time >= ? AND cms.expect_month_time <= ? AND 1=1 ORDER BY cms.modify_time desc) tmp_count
==> Parameters: 2021-03-01 00:00:00.0(Timestamp), 2021-03-31 00:00:00.0(Timestamp)
<==    Columns: count(0)
<==        Row: 66
<==      Total: 1
==>  Preparing: SELECT DISTINCT cms.id, cms.rpid as rpId, cms.`code`, pcc.area_id, pa.`name` area_name, pcc.mu_id, pu.`name` mu_name, cms.center_id, pcc.`name` center_name, cms.contract_id, bci.contract_code, case when bci.contract_name is null then cms.contract_name else bci.contract_name end as contract_name, cms.gross_margin_rate, cms.expect_gross_margin, cms.actual_gross_margin, case when bci.tax_rate is null then cms.tax_rate else bci.tax_rate end tax_rate, bci.user_id, uoc.alias user_name, cms.recv_milepost, cms.plan_month, cms.expect_month_time, cms.expect_month_amount, CASE WHEN bci.tax_rate IS NULL THEN ROUND(cms.expect_month_amount /(1+cms.tax_rate / 100), 2) ELSE ROUND(cms.expect_month_amount /(1+bci.tax_rate / 100), 2) END expect_month_income, cms.recv_power_prediction, cms.returnable, cms.expect_week_time, cms.expect_week_amount, CASE WHEN bci.tax_rate IS NULL THEN ROUND(cms.expect_week_amount /(1+cms.tax_rate / 100), 2) ELSE ROUND(cms.expect_week_amount /(1+bci.tax_rate / 100), 2) END expect_week_income, cms.week_recv_power_prediction, cms.week_returnable, cms.actual_recv_time, cms.actual_recv_income, CASE WHEN cms.actual_plan_recv_income IS NULL THEN NULL WHEN (CASE WHEN bci.tax_rate IS NULL THEN ROUND(cms.expect_month_amount /(1+cms.tax_rate / 100), 2) ELSE ROUND(cms.expect_month_amount /(1+bci.tax_rate / 100), 2) END) > cms.actual_plan_recv_income then cms.actual_plan_recv_income ELSE( (CASE WHEN bci.tax_rate IS NULL THEN ROUND(cms.expect_month_amount /(1+cms.tax_rate / 100), 2) ELSE ROUND(cms.expect_month_amount /(1+bci.tax_rate / 100), 2) END) ) END actual_plan_recv_income, cms.receivable_flag, cms.recv_progress, cms.manage_power_predict, cms.manage_power_income, case when cms.expect_month_time < DATE_ADD( CURRENT_DATE, INTERVAL - DAY ( CURRENT_DATE ) + 1 DAY ) then 'archive' when cal.type is null then cms.status else cal.type end as status, cms.creator, cms.create_time, cms.modifier, cms.modify_time FROM contract_monthly_schedule cms LEFT JOIN busiopt_contract_info bci ON cms.contract_id = bci.contract_id LEFT JOIN user_organ_collect uoc ON uoc.user_id = cms.user_id LEFT JOIN ( SELECT contract_milepost_code, sum( money ) sum_money, max( collection_time ) max_collection_time FROM contract_payment_new GROUP BY contract_milepost_code order by null) cp ON cp.contract_milepost_code = cms.code LEFT JOIN product_cloud_center pcc ON cms.center_id = pcc.id LEFT JOIN product_mu pu ON pu.`id` = pcc.mu_id LEFT JOIN product_area pa ON pa.`id` = pcc.area_id LEFT JOIN contract_audit_lock cal ON cal.plan_month = cms.plan_month WHERE 1 = 1 AND cms.expect_month_time >= ? AND cms.expect_month_time <= ? AND 1=1 ORDER BY cms.modify_time desc LIMIT ?
==> Parameters: 2021-03-01 00:00:00.0(Timestamp), 2021-03-31 00:00:00.0(Timestamp), 10(Integer)
<==    Columns: id, rpId, code, area_id, area_name, mu_id, mu_name, center_id, center_name, contract_id, contract_code, contract_name, gross_margin_rate, expect_gross_margin, actual_gross_margin, tax_rate, user_id, user_name, recv_milepost, plan_month, expect_month_time, expect_month_amount, expect_month_income, recv_power_prediction, returnable, expect_week_time, expect_week_amount, expect_week_income, week_recv_power_prediction, week_returnable, actual_recv_time, actual_recv_income, actual_plan_recv_income, receivable_flag, recv_progress, manage_power_predict, manage_power_income, status, creator, create_time, modifier, modify_time
<==        Row: 404659662171398144, 404659662171398144_2021-03, ZWY3931, 202006050002, 重庆中心, 18, 重庆, 16, 重庆, 2020121797449, 700255749, 重庆市电子政务办互联网+网审项目, 30.00, 1974910.75, null, 6, 907894, 重庆市人民政府电子政务中心, 服务费, 2021-03, 2021-03-31, 6978018.00, 6583035.85, 60, 可能, 2021-03-31, 6978018.00, 6583035.85, 60, 可能, null, null, null, no, null, null, null, commit, xiaoxiao01@inspur.com, 2021-01-21 15:33:01.0, xiaoxiao01@inspur.com, 2021-01-27 15:56:52.0
<==        Row: 406835242084990976, 406835242084990976_2021-03, 00000000, 202006050002, 重庆中心, 18, 重庆, 16, 重庆, null, null, 建设银行互联网+政务项目, 20.00, 283018.87, null, 6.00, null, null, null, 2021-03, 2021-03-31, 1500000.00, 1415094.34, 80, 承诺, 2021-03-31, 1500000.00, 1415094.34, 80, 承诺, null, null, null, no, null, null, null, commit, chengqilin@inspur.com, 2021-01-27 15:38:00.0, chengqilin@inspur.com, 2021-01-27 15:38:17.0
<==        Row: 406833838957256704, 406833838957256704_2021-03, 00000000, 202006050002, 重庆中心, 18, 重庆, 16, 重庆, null, null, 重庆市综合经济研究院信用二期扩容及粮食监管系统, 20.00, 1132075.47, null, 6.00, null, null, null, 2021-03, 2021-03-31, 6000000.00, 5660377.36, 40, 可能, 2021-03-31, 6000000.00, 5660377.36, 40, 可能, null, null, null, no, null, null, null, commit, chengqilin@inspur.com, 2021-01-27 15:32:26.0, chengqilin@inspur.com, 2021-01-27 15:38:17.0
<==        Row: 404687855710633984, 404687855710633984_2021-02, 00000000, 202006050007, 湖南中心, 9, 湖南, 230, 娄底, null, null, 云上娄底大数据中心服务项目, 20.00, 305660.38, null, 6.00, null, null, null, 2021-03, 2021-03-31, 1620000.00, 1528301.89, 30, 可能, 2021-02-28, 1620000.00, 1528301.89, 30, 可能, null, null, null, no, null, null, null, commit, xiaoxiao01@inspur.com, 2021-01-21 17:25:04.0, xiaoxiao01@inspur.com, 2021-01-27 14:33:50.0
<==        Row: 398427574472531968, 398427574472531968_2021-03, ZWY1697, 202006050001, 山东中心, 12, 山东, 183, 德州, 270512198182, YX18090502, 齐河县电子政务公共服务云平台服务项目, 30.00, 112881.79, null, 6, 811927, 齐河县人民政府办公室, 年度服务费, 2021-03, 2021-03-31, 398849.00, 376272.64, 30, 可能, 2021-03-31, 398849.00, 376272.64, 30, 可能, null, null, null, no, null, null, null, commit, renpeipei@inspur.com, 2021-01-04 10:48:56.0, xiaoxiao01@inspur.com, 2021-01-27 14:20:42.0
<==        Row: 398427587470680064, 398427587470680064_2021-03, ZWY1816, 202006050007, 湖南中心, 9, 湖南, 225, 张家界, 270512198365, YX18091201, 张家界智慧城市云计算大数据中心服务项目合作协议, 39.61, 1606820.75, null, 6, 820604, 张家界市经济发展投资集团有限公司, 服务费（第二年）, 2021-03, 2021-03-22, 4300000.00, 4056603.77, 60, 可能, 2021-03-22, 4300000.00, 4056603.77, 60, 可能, null, null, null, no, null, null, null, commit, renpeipei@inspur.com, 2021-01-04 10:48:59.0, renpeipei@inspur.com, 2021-01-27 13:47:49.0
<==        Row: 406784640843907072, 406784640843907072_2021-03, 00000000, 202006050001, 山东中心, 12, 山东, 170, 济南, null, null, 济南医保专享云建设项目, 30.00, 2156603.77, null, 6.00, null, null, null, 2021-03, 2021-03-31, 7620000.00, 7188679.25, 60, 可能, 2021-03-31, 7620000.00, 7188679.25, 60, 可能, null, null, null, no, null, null, null, commit, sunhz@inspur.com, 2021-01-27 12:16:56.0, sunhz@inspur.com, 2021-01-27 12:20:11.0
<==        Row: 406785389310238720, 406785389310238720_2021-03, 00000000, 202006050001, 山东中心, 12, 山东, 170, 济南, null, null, 济南市交通大脑项目技术服务合同（框架合同）-2020下半年, 20.00, 556603.77, null, 6.00, null, null, null, 2021-03, 2021-03-31, 2950000.00, 2783018.87, 70, 可能, 2021-03-31, 2950000.00, 2783018.87, 70, 可能, null, null, null, no, null, null, null, commit, sunhz@inspur.com, 2021-01-27 12:19:55.0, sunhz@inspur.com, 2021-01-27 12:19:55.0
<==        Row: 404659677451247616, 404659677451247616_2021-03, ZWY4062, 202006050004, 云南中心, 17, 云南, 303, 昆明, 2020123188880, 700252564, 无线政务交换系统项目云服务采购项目, 30.32, 25257.13, null, 6, 905190, 昆明市生态环境局西山分局, 服务费, 2021-03, 2021-03-31, 88300.00, 83301.89, 30, 可能, 2021-03-31, 88300.00, 83301.89, 30, 可能, null, null, null, no, null, null, null, commit, xiaoxiao01@inspur.com, 2021-01-21 15:33:05.0, xiaoxiao01@inspur.com, 2021-01-27 11:48:42.0
<==        Row: 404663757779230720, 404663757779230720_2021-03, ZWY4116, 202006050006, 山西中心, 13, 山西, 56, 忻州, 2021010545751, 0700258650, 忻州市政务云服务采购二期项目, 30.50, 1720660.38, null, 6, 40111588, 忻州市人民政府办公室, 服务费, 2021-03, 2021-03-31, 5980000.00, 5641509.43, 50, 可能, 2021-03-31, 5980000.00, 5641509.43, 50, 可能, null, null, null, no, null, null, null, commit, xiaoxiao01@inspur.com, 2021-01-21 15:49:18.0, xiaoxiao01@inspur.com, 2021-01-27 11:47:33.0
<==      Total: 10
Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4700a014]
Creating a new SqlSession
SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@988bc1b] was not registered for synchronization because synchronization is not active
JDBC Connection [com.alibaba.druid.proxy.jdbc.ConnectionProxyImpl@7ba67256] will not be managed by Spring
==>  Preparing: SELECT IFNULL(sum(CASE WHEN bci.tax_rate IS NULL THEN ROUND(cms.expect_month_amount /(1+cms.tax_rate / 100), 2) ELSE ROUND(cms.expect_month_amount /(1+bci.tax_rate / 100), 2) END), 0) AS month_expect_amount FROM contract_monthly_schedule cms LEFT JOIN busiopt_contract_info bci ON cms.contract_id = bci.contract_id LEFT JOIN user_organ_collect uoc ON uoc.user_id = cms.user_id LEFT JOIN ( SELECT contract_milepost_code, sum( money ) sum_money, max( collection_time ) max_collection_time FROM contract_payment_new GROUP BY contract_milepost_code ) cp ON cp.contract_milepost_code = cms.code LEFT JOIN product_cloud_center pcc ON cms.center_id = pcc.id LEFT JOIN product_mu pu ON pu.`code` = pcc.mu_id LEFT JOIN product_area pa ON pa.`id` = pcc.area_id LEFT JOIN contract_audit_lock cal ON cal.plan_month = cms.plan_month WHERE 1=1 AND DATE_FORMAT( cms.expect_month_time, '%Y%m' ) = DATE_FORMAT( CURDATE( ) , '%Y%m' )
==> Parameters:
<==    Columns: month_expect_amount
<==        Row: 35179343.62
<==      Total: 1
Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@988bc1b]
2021-01-27 16:01:53.923  INFO 14515 --- [nio-8765-exec-3] c.i.c.b.c.p.v.PermissionValidation       : 超级管理员角色key:  system-service:data-auth:user:ea7b8719-8cdc-4df5-859a-103cf007fb77
2021-01-27 16:01:53.924  INFO 14515 --- [nio-8765-exec-3] c.i.c.b.c.p.v.PermissionValidation       : 超级管理员角色value: "superman"
Creating a new SqlSession
SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6eec997d] was not registered for synchronization because synchronization is not active
JDBC Connection [com.alibaba.druid.proxy.jdbc.ConnectionProxyImpl@7ba67256] will not be managed by Spring
==>  Preparing: SELECT IFNULL(sum(ctpp.price), 0) as price FROM contract_target_price_payment ctpp INNER JOIN contract_target_payment ctp ON ctpp.target_id = ctp.id WHERE ctp.year = ? AND ctpp.duration = ? AND 1=1
==> Parameters: 2020(String), 13(String)
<==    Columns: price
<==        Row: 45540000.00
<==      Total: 1
Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@6eec997d]
2021-01-27 16:01:53.928  INFO 14515 --- [nio-8765-exec-3] .c.b.c.p.s.MonthlyPaymentScheduleService : searchVO=[SumReservoirSearchVO(monthExpectAmount=3518, monthTargetAmount=4554, decimalRate=null, expectAchiveRate=null)]


ZWY1028
