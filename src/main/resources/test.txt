2021-01-27 16:01:08.712  INFO 14515 --- [nio-8765-exec-7] .c.b.c.p.s.MonthlyPaymentScheduleService : 应回款水库查询：[ReceivablesReservoirSearchDTO(deadline=null, startPlanMonth=Mon Mar 01 00:00:00 CST 2021, endPlanMonth=Wed Mar 31 00:00:00 CST 2021, contractId=null, contractCode=null, code=null, areaId=null, muId=null, centerId=null, status=commit, count=null, currentPage=1, pageSize=10, dataAuth=null)]
2021-01-27 16:01:08.713  INFO 14515 --- [nio-8765-exec-7] c.i.c.b.c.p.v.PermissionValidation       : 超级管理员角色key:  system-service:data-auth:user:ea7b8719-8cdc-4df5-859a-103cf007fb77
2021-01-27 16:01:08.714  INFO 14515 --- [nio-8765-exec-7] c.i.c.b.c.p.v.PermissionValidation       : 超级管理员角色value: "superman"
Creating a new SqlSession
SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4e42168] was not registered for synchronization because synchronization is not active
JDBC Connection [com.alibaba.druid.proxy.jdbc.ConnectionProxyImpl@7ba67256] will not be managed by Spring
==>  Preparing: select count(0) from (SELECT crd.id, crd.`code`, pcc.area_id, pa.`name` area_name, pcc.mu_id, pu.`name` mu_name, crd.center_id, pcc.`name` center_name, crd.contract_id, bci.contract_code, case when bci.contract_name is null then crd.contract_name else bci.contract_name end as contract_name, crd.recv_type, crd.recv_milepost, crd.receivables_date, crd.receivables_amount, CASE WHEN bci.tax_rate IS NULL THEN ROUND(crd.receivables_amount /(1+crd.tax_rate / 100), 2) ELSE ROUND(crd.receivables_amount /(1+bci.tax_rate / 100), 2) END receivables_income, crd.expect_month_time, crd.expect_month_amount, CASE WHEN bci.tax_rate IS NULL THEN ROUND(crd.expect_month_amount /(1+crd.tax_rate / 100), 2) ELSE ROUND(crd.expect_month_amount /(1+bci.tax_rate / 100), 2) END expect_month_income, CASE WHEN bci.tax_rate IS NULL THEN ROUND((crd.expect_month_amount /(1+crd.tax_rate / 100) * crd.gross_margin_rate / 100), 2) ELSE ROUND((crd.expect_month_amount /(1+bci.tax_rate / 100) * crd.gross_margin_rate / 100), 2) END expect_gross_margin, bci.amount, cp.max_collection_time actual_receipt_date, cp.sum_money actual_receipt_amount, crd.receivables_amount - IF(cp.sum_money IS NULL, 0, cp.sum_money) not_receipt_amount, CASE WHEN bci.tax_rate IS NULL THEN ROUND(( crd.receivables_amount - IF(cp.sum_money IS NULL, 0, cp.sum_money) )/(1+crd.tax_rate / 100), 2) ELSE ROUND(( crd.receivables_amount - IF(cp.sum_money IS NULL, 0, cp.sum_money) )/(1+bci.tax_rate / 100), 2) END not_receipt_income, crd.gross_margin_rate, CASE WHEN bci.tax_rate IS NULL THEN crd.tax_rate ELSE bci.tax_rate END tax_rate, crd.recv_power_prediction, crd.returnable, crd.remark, crd.manage_power_predict, crd.manage_power_income, crd.STATUS, crd.count, crd.commit_time, crd.creator, crd.create_time, crd.modifier, crd.modify_time FROM contract_receivables_detail crd LEFT JOIN busiopt_contract_info bci ON crd.contract_id = bci.contract_id LEFT JOIN ( SELECT contract_milepost_code, sum( money ) sum_money, max( collection_time ) max_collection_time FROM contract_payment_new GROUP BY contract_milepost_code order by null) cp ON cp.contract_milepost_code = crd.code LEFT JOIN product_cloud_center pcc ON crd.center_id = pcc.id LEFT JOIN product_mu pu ON pu.`id` = pcc.mu_id LEFT JOIN product_area pa ON pa.`id` = pcc.area_id WHERE 1 = 1 AND crd.expect_month_time >= ? AND crd.expect_month_time <= ? AND crd.status = 'commit' AND 1=1 AND (crd.receivables_amount > cp.sum_money OR cp.sum_money IS NULL) ORDER BY crd.modify_time desc) tmp_count 
==> Parameters: 2021-03-01 00:00:00.0(Timestamp), 2021-03-31 00:00:00.0(Timestamp)
<==    Columns: count(0)
<==        Row: 66
<==      Total: 1
==>  Preparing: SELECT crd.id, crd.`code`, pcc.area_id, pa.`name` area_name, pcc.mu_id, pu.`name` mu_name, crd.center_id, pcc.`name` center_name, crd.contract_id, bci.contract_code, case when bci.contract_name is null then crd.contract_name else bci.contract_name end as contract_name, crd.recv_type, crd.recv_milepost, crd.receivables_date, crd.receivables_amount, CASE WHEN bci.tax_rate IS NULL THEN ROUND(crd.receivables_amount /(1+crd.tax_rate / 100), 2) ELSE ROUND(crd.receivables_amount /(1+bci.tax_rate / 100), 2) END receivables_income, crd.expect_month_time, crd.expect_month_amount, CASE WHEN bci.tax_rate IS NULL THEN ROUND(crd.expect_month_amount /(1+crd.tax_rate / 100), 2) ELSE ROUND(crd.expect_month_amount /(1+bci.tax_rate / 100), 2) END expect_month_income, CASE WHEN bci.tax_rate IS NULL THEN ROUND((crd.expect_month_amount /(1+crd.tax_rate / 100) * crd.gross_margin_rate / 100), 2) ELSE ROUND((crd.expect_month_amount /(1+bci.tax_rate / 100) * crd.gross_margin_rate / 100), 2) END expect_gross_margin, bci.amount, cp.max_collection_time actual_receipt_date, cp.sum_money actual_receipt_amount, crd.receivables_amount - IF(cp.sum_money IS NULL, 0, cp.sum_money) not_receipt_amount, CASE WHEN bci.tax_rate IS NULL THEN ROUND(( crd.receivables_amount - IF(cp.sum_money IS NULL, 0, cp.sum_money) )/(1+crd.tax_rate / 100), 2) ELSE ROUND(( crd.receivables_amount - IF(cp.sum_money IS NULL, 0, cp.sum_money) )/(1+bci.tax_rate / 100), 2) END not_receipt_income, crd.gross_margin_rate, CASE WHEN bci.tax_rate IS NULL THEN crd.tax_rate ELSE bci.tax_rate END tax_rate, crd.recv_power_prediction, crd.returnable, crd.remark, crd.manage_power_predict, crd.manage_power_income, crd.STATUS, crd.count, crd.commit_time, crd.creator, crd.create_time, crd.modifier, crd.modify_time FROM contract_receivables_detail crd LEFT JOIN busiopt_contract_info bci ON crd.contract_id = bci.contract_id LEFT JOIN ( SELECT contract_milepost_code, sum( money ) sum_money, max( collection_time ) max_collection_time FROM contract_payment_new GROUP BY contract_milepost_code order by null) cp ON cp.contract_milepost_code = crd.code LEFT JOIN product_cloud_center pcc ON crd.center_id = pcc.id LEFT JOIN product_mu pu ON pu.`id` = pcc.mu_id LEFT JOIN product_area pa ON pa.`id` = pcc.area_id WHERE 1 = 1 AND crd.expect_month_time >= ? AND crd.expect_month_time <= ? AND crd.status = 'commit' AND 1=1 AND (crd.receivables_amount > cp.sum_money OR cp.sum_money IS NULL) ORDER BY crd.modify_time desc LIMIT ? 
==> Parameters: 2021-03-01 00:00:00.0(Timestamp), 2021-03-31 00:00:00.0(Timestamp), 10(Integer)
<==    Columns: id, code, area_id, area_name, mu_id, mu_name, center_id, center_name, contract_id, contract_code, contract_name, recv_type, recv_milepost, receivables_date, receivables_amount, receivables_income, expect_month_time, expect_month_amount, expect_month_income, expect_gross_margin, amount, actual_receipt_date, actual_receipt_amount, not_receipt_amount, not_receipt_income, gross_margin_rate, tax_rate, recv_power_prediction, returnable, remark, manage_power_predict, manage_power_income, STATUS, count, commit_time, creator, create_time, modifier, modify_time
<==        Row: 406835242084990976, 00000000, 202006050002, 重庆中心, 18, 重庆, 16, 重庆, null, null, 建设银行互联网+政务项目, null, null, 2021-03-31, null, null, 2021-03-31, 1500000.00, 1415094.34, 283018.87, null, null, null, null, null, 20.00, 6.00, 80, 承诺, <<BLOB>>, null, null, commit, 2, 2021-01-27 15:57:00.0, chengqilin@inspur.com, 2021-01-27 15:38:00.0, chengqilin@inspur.com, 2021-01-27 15:57:00.0
<==        Row: 406833838957256704, 00000000, 202006050002, 重庆中心, 18, 重庆, 16, 重庆, null, null, 重庆市综合经济研究院信用二期扩容及粮食监管系统, null, null, 2021-03-31, null, null, 2021-03-31, 6000000.00, 5660377.36, 1132075.47, null, null, null, null, null, 20.00, 6.00, 40, 可能, <<BLOB>>, null, null, commit, 2, 2021-01-27 15:57:00.0, chengqilin@inspur.com, 2021-01-27 15:32:26.0, chengqilin@inspur.com, 2021-01-27 15:57:00.0
<==        Row: 404659662171398144, ZWY3931, 202006050002, 重庆中心, 18, 重庆, 16, 重庆, 2020121797449, 700255749, 重庆市电子政务办互联网+网审项目, 01, 服务费, 2020-12-31, 6978018.00, 6583035.85, 2021-03-31, 6978018.00, 6583035.85, 1974910.75, 6978018.00, null, null, 6978018.00, 6583035.85, 30.00, 6, 60, 可能, <<BLOB>>, null, null, commit, 1, 2021-01-27 15:57:00.0, xiaoxiao01@inspur.com, 2021-01-21 15:33:01.0, xiaoxiao01@inspur.com, 2021-01-27 15:57:00.0
<==        Row: 398427504285048832, ZWY1028, 202006050001, 山东中心, 12, 山东, 180, 日照, 270512198289, 20170316, 日照市政务云服务提供商项目合同, 01, 服务费（2020年下半年）, 2021-02-27, 111.11, 104.82, 2021-03-31, 6000000.00, 5660377.36, 2263018.87, 40000000.00, null, null, 111.11, 104.82, 39.98, 6, 50, 可能, <<BLOB>>, null, null, commit, 7, 2021-01-27 15:53:08.0, renpeipei@inspur.com, 2021-01-04 10:48:39.0, renpeipei@inspur.com, 2021-01-27 15:53:08.0
<==        Row: 404687855710633984, 00000000, 202006050007, 湖南中心, 9, 湖南, 230, 娄底, null, null, 云上娄底大数据中心服务项目, null, null, 2021-01-31, null, null, 2021-03-31, 1620000.00, 1528301.89, 305660.38, null, null, null, null, null, 20.00, 6.00, 30, 可能, <<BLOB>>, null, null, commit, 5, 2021-01-27 14:33:49.0, xiaoxiao01@inspur.com, 2021-01-21 17:25:04.0, xiaoxiao01@inspur.com, 2021-01-27 14:33:49.0
<==        Row: 398427574472531968, ZWY1697, 202006050001, 山东中心, 12, 山东, 183, 德州, 270512198182, YX18090502, 齐河县电子政务公共服务云平台服务项目, 01, 年度服务费, 2021-03-31, 1000000.00, 943396.23, 2021-03-31, 398849.00, 376272.64, 112881.79, 3000000.00, null, null, 1000000.00, 943396.23, 30.00, 6, 30, 可能, <<BLOB>>, null, null, commit, 3, 2021-01-27 14:20:01.0, renpeipei@inspur.com, 2021-01-04 10:48:56.0, renpeipei@inspur.com, 2021-01-27 14:20:01.0
<==        Row: 404659677451247616, ZWY4062, 202006050004, 云南中心, 17, 云南, 303, 昆明, 2020123188880, 700252564, 无线政务交换系统项目云服务采购项目, 01, 服务费, 2021-01-31, 88300.00, 83301.89, 2021-03-31, 88300.00, 83301.89, 25257.13, 264900.00, null, null, 88300.00, 83301.89, 30.32, 6, 30, 可能, <<BLOB>>, null, null, commit, 1, 2021-01-27 14:20:01.0, xiaoxiao01@inspur.com, 2021-01-21 15:33:05.0, xiaoxiao01@inspur.com, 2021-01-27 14:20:01.0
<==        Row: 404663756684517376, ZWY4106, 202006050013, 华中区域, 11, 江西, 163, 新余, 2021010503693, 0700258604, 新余日报社网站购买云服务, 01, 服务费, 2021-02-28, 38760.00, 36566.04, 2021-03-26, 38760.00, 36566.04, 10969.81, 38760.00, null, null, 38760.00, 36566.04, 30.00, 6, 50, 可能, <<BLOB>>, null, null, commit, 1, 2021-01-27 14:20:01.0, xiaoxiao01@inspur.com, 2021-01-21 15:49:17.0, xiaoxiao01@inspur.com, 2021-01-27 14:20:01.0
<==        Row: 398427606122749952, ZWY1995, 202006050004, 云南中心, 17, 云南, 303, 昆明, 270512198252, YX18113002, 昆明市智慧城市建设投资有限公司呈贡区“智慧呈贡”机柜及大数据中心租赁服务项目服务采购合同, 01, 年度服务费（第三年：60%）, 2021-01-31, 7302000.00, 6888679.25, 2021-03-31, 7302000.00, 6888679.25, 2289796.98, 25920000.00, null, null, 7302000.00, 6888679.25, 33.24, 6, 30, 可能, <<BLOB>>, null, null, commit, 1, 2021-01-27 14:20:01.0, renpeipei@inspur.com, 2021-01-04 10:49:03.0, renpeipei@inspur.com, 2021-01-27 14:20:01.0
<==        Row: 406478625418903552, 00000000, 202006050015, 华北区域, 30, 内蒙古, 61, 乌海, null, null, 乌海市公安局交通警察支队租赁服务, null, null, 2021-03-22, null, null, 2021-03-22, 104500.00, 98584.91, 49292.45, null, null, null, null, null, 50.00, 6.00, 60, 可能, <<BLOB>>, null, null, commit, 1, 2021-01-27 13:57:31.0, wangqinm@inspur.com, 2021-01-26 16:00:56.0, wangqinm@inspur.com, 2021-01-27 13:57:31.0
<==      Total: 10
Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4e42168]
Creating a new SqlSession
SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7554c06c] was not registered for synchronization because synchronization is not active
JDBC Connection [com.alibaba.druid.proxy.jdbc.ConnectionProxyImpl@7ba67256] will not be managed by Spring
==>  Preparing: SELECT IFNULL(sum(CASE WHEN bci.tax_rate IS NULL THEN ROUND(crd.expect_month_amount /(1+crd.tax_rate / 100), 2) ELSE ROUND(crd.expect_month_amount /(1+bci.tax_rate / 100), 2) END), 0) AS month_expect_amount FROM contract_receivables_detail crd LEFT JOIN busiopt_contract_info bci ON crd.contract_id = bci.contract_id LEFT JOIN ( SELECT contract_milepost_code, sum( money ) sum_money, max( collection_time ) max_collection_time FROM contract_payment_new GROUP BY contract_milepost_code ) cp ON cp.contract_milepost_code = crd.code LEFT JOIN product_cloud_center pcc ON crd.center_id = pcc.id LEFT JOIN product_mu pu ON pu.`code` = pcc.mu_id LEFT JOIN product_area pa ON pa.`id` = pcc.area_id WHERE 1=1 AND crd.expect_month_time between ? and ? 
==> Parameters: 2021-01-01 00:00:00.0(Timestamp), 2021-01-31 00:00:00.0(Timestamp)
<==    Columns: month_expect_amount
<==        Row: 29640611.19
<==      Total: 1
Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@7554c06c]
2021-01-27 16:01:08.810  INFO 14515 --- [nio-8765-exec-7] c.i.c.b.c.p.v.PermissionValidation       : 超级管理员角色key:  system-service:data-auth:user:ea7b8719-8cdc-4df5-859a-103cf007fb77
2021-01-27 16:01:08.811  INFO 14515 --- [nio-8765-exec-7] c.i.c.b.c.p.v.PermissionValidation       : 超级管理员角色value: "superman"
Creating a new SqlSession
SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1ffd7532] was not registered for synchronization because synchronization is not active
JDBC Connection [com.alibaba.druid.proxy.jdbc.ConnectionProxyImpl@7ba67256] will not be managed by Spring
==>  Preparing: SELECT IFNULL(sum(ctpp.price), 0) as price FROM contract_target_price_payment ctpp INNER JOIN contract_target_payment ctp ON ctpp.target_id = ctp.id WHERE ctp.year = ? AND ctpp.duration = ? AND 1=1 
==> Parameters: 2020(String), 13(String)
<==    Columns: price
<==        Row: 45540000.00
<==      Total: 1
Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@1ffd7532]
2021-01-27 16:01:08.821  INFO 14515 --- [nio-8765-exec-7] .c.b.c.p.s.MonthlyPaymentScheduleService : searchVO=[SumReservoirSearchVO(monthExpectAmount=2964, monthTargetAmount=4554, decimalRate=null, expectAchiveRate=null)]
2021-01-27 16:01:08.822  INFO 14515 --- [nio-8765-exec-7] .c.b.c.p.s.MonthlyPaymentScheduleService : 应回款水库查询：end
